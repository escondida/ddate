CC ?= clang
CFLAGS += \
	-Wall -Wextra -g -ggdb  \
	-std=c11 -O2 -fPIE -march=native -D_FORTIFY_SOURCE=2 \
	-fstack-protector-strong --param=ssp-buffer-size=1 -flto \
	-fsanitize=undefined

ifeq "$(CC)" "clang"
CFLAGS += -Weverything -fno-diagnostics-color -fsanitize-trap=undefined
endif

LDFLAGS += -Wl,-z,relro,-z,now,--build-id -pie

SLOGANS = \
	ddata/slogans/discordian \
	ddata/slogans/miscellaneous \
	ddata/slogans/neologisms \
	@EXTRASLOGANS@

all: ddate slogans

ddate: src/ddate.c src/slogans.c
	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ $<

slogans: $(SLOGANS)
	cat $< > $@

clean:
	rm -f ddate

nuke: clean
	rm -f Makefile mkfile

.PHONY: all clean nuke
